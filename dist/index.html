<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fabric</title>
    <script src="./fabric.min.js"></script>
    <style>
      body {
        display: flex;
      }
      canvas {
        border: 1px solid #2c63ff;
      }
      textarea {
        width: 200px;
        height: 126px;
        margin-left: 20px;
        font-size: 30px;
        font-family: "Comic Sans";
      }
    </style>
  </head>
  <body>
    <canvas id="canvas" width="800" height="800"></canvas>
    <textarea id="textarea"></textarea>
    <!-- <div id="textarea-wrap"></div> -->
    <script>
      // fabric.disableStyleCopyPaste = true
      // const canvas = new fabric.StaticCanvas("canvas");
      const canvas = new fabric.Canvas("canvas");

      // æ­£æ–¹å½¢
      const rect = new fabric.Rect({
        top: 188,
        left: 45,
        width: 65,
        height: 65,
        fill: "#2c63ff",
      });
      canvas.add(rect);

      // æ·»åŠ æ–‡å­—
      // const text = new fabric.Text('hello world', { left: 100, top: 100 });
      // canvas.add(text);

      const O2TextStyle = { fontWeight: "bold", fill: "#ffffff" };

      // æ·»åŠ å¯ç¼–è¾‘æ–‡å­—
      const duckText = new fabric.IText(
        "\u004F2 Lab\nSuperlinğŸ¦†ğŸ¦†\nè¿™é‡Œæ˜¯æ·±åœ³",
        {
          fontFamily: "Comic Sans",
          top: 200,
          left: 50,
          styles: {
            0: {
              0: O2TextStyle,
              1: O2TextStyle,
            },
          },
          // direction: 'rtl',
          // hasControls: false,
          // hiddenTextareaContainer: document.querySelector('#textarea-wrap')
        }
      );
      canvas.add(duckText);

      const helloText = new fabric.IText("hello, fabric", {
        fontFamily: "Comic Sans",
        top: 80,
        left: 50,
      });
      canvas.add(helloText);

      const zhText = new fabric.IText("ğ¯ „å¥½\nè¿™é‡Œæ˜¯æ·±åœ³", {
        fontFamily: "Comic Sans",
        top: 400,
        left: 50,
      });
      canvas.add(zhText);

      // æ·»åŠ ä¸å¯ç¼–è¾‘æ–‡å­—
      //  const uneditableText = new fabric.IText("It's uneditable", {
      //     width: 500,
      //     fontFamily: 'Comic Sans',
      //     editable: false,
      //     // direction: 'rtl',
      // });
      // canvas.add(uneditableText);

      // æ·»åŠ  textbox
      const textbox = new fabric.Textbox(
        "This lib is free for everyone.\nSome things are not.\nPeople behind FabricJS acknowledge that Black people have to fight for basic rights, against systemic racism, unequal opportunities and injustice across the ğŸŒ.\nWe know this is wrong and we are ğŸ’”. ğŸ’ªğŸ½ğŸ’ªğŸ¾ğŸ’ªğŸ¿!",
        {
          fontFamily: "Comic Sans",
          width: 460,
          top: 550,
          left: 50,
          fontSize: 16,
          splitByGrapheme: true,
        }
      );
      canvas.add(textbox);
    </script>
    <script>
      // ç›‘å¬å•ä¸ªå›¾å±‚çš„äº‹ä»¶
      duckText.on("selection:changed", function (options) {
        console.log("[duckText] selection:changed: ", options);
      });

      // ç›‘å¬æ‰€æœ‰æ–‡æœ¬é€‰åŒºå˜åŒ–äº‹ä»¶
      canvas.on("text:selection:changed", function (options) {
        // console.log('[canvas] text:selection:changed: ', options);
      });
    </script>
    <script>
      const textarea = document.getElementById("textarea");

      // textarea.value = 'A \uD87E\uDC04 Z'
      textarea.value = "O2 Lab\nSuperlin ğŸ¦†ğŸ¦†\nè¿™é‡Œæ˜¯æ·±åœ³";

      /**
       * è§¦å‘æ¡ä»¶æ˜¯ textarea æ˜¯å¤±å»ç„¦ç‚¹
       */
      textarea.addEventListener("change", function (e) {
        console.log("[textarea] change: ", e.target.value);
      });

      /**
       * è§¦å‘é¡ºåº paste -> input
       */
      textarea.addEventListener("input", function (e) {
        console.log("[textarea] input: ", e.target.value);
      });
      textarea.addEventListener("paste", function (e) {
        console.log("[textarea] paste: ", e);
      });
    </script>
  </body>
</html>
